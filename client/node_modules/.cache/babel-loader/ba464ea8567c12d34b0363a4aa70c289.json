{"ast":null,"code":"var _jsxFileName = \"/Users/daylanberry/Desktop/clothing/client/src/components/chat-components/Chat.jsx\";\nimport React from 'react';\nimport './Chat.scss';\nimport { connect } from 'react-redux';\nimport { toggleChatModal } from '../../redux/chat/chat.actions';\nimport { ChatManager, TokenProvider } from '@pusher/chatkit-client';\nimport SendMessage from './SendMessage';\nimport MessageList from './MessageList';\nimport RoomList from './RoomList';\nimport { selectCurrentUser } from '../../redux/user/user.selector';\nimport { createStructuredSelector } from 'reselect';\nimport keys from '../../keys.js';\nimport axios from 'axios';\n\nclass Chat extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.sendMessage = (text, roomId) => {\n      this.currentUser.sendSimpleMessage({\n        text,\n        roomId: this.state.roomId\n      });\n    };\n\n    this.getRooms = () => {\n      this.currentUser.getJoinableRooms().then(joinableRooms => {\n        this.setState({\n          joinableRooms,\n          currentUser: this.currentUser,\n          joinedRooms: this.currentUser.rooms\n        });\n      }).catch(err => console.log(err));\n    };\n\n    this.subscribeToRoom = roomId => {\n      this.setState({\n        messages: []\n      });\n      this.currentUser.subscribeToRoom({\n        roomId: roomId,\n        hooks: {\n          onMessage: message => {\n            this.setState({\n              messages: [...this.state.messages, message]\n            });\n          }\n        }\n      }).then(room => {\n        this.setState({\n          roomId: room.id\n        });\n      }).catch(err => console.log(err));\n    };\n\n    this.createUser = user => {\n      axios.post('/users', {\n        username: user\n      }).then(res => console.log(res)).catch(err => console.log(err));\n    };\n\n    this.state = {\n      messages: [],\n      currentUser: {},\n      joinableRooms: [],\n      joinedRooms: [],\n      roomId: null,\n      userId: ''\n    };\n  }\n\n  componentDidMount() {\n    console.log(this.props.user.displayName);\n    const chatManager = new ChatManager({\n      instanceLocator: keys.instanceLocator,\n      userId: 'daylan',\n      tokenProvider: new TokenProvider({\n        url: keys.tokenUrl\n      })\n    });\n    chatManager.connect().then(currentUser => {\n      this.currentUser = currentUser;\n      this.getRooms();\n    }).catch(err => console.log(err));\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"chat-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"aside\", {\n      className: \"rooms\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(RoomList, {\n      rooms: [...this.state.joinableRooms, ...this.state.joinedRooms],\n      subscribeToRoom: this.subscribeToRoom,\n      roomId: this.state.roomId,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    })), React.createElement(\"section\", {\n      className: \"texts\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(MessageList, {\n      messages: this.state.messages,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    })), React.createElement(\"span\", {\n      onClick: () => this.props.toggleHidden(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, \"\\u2715\")), React.createElement(SendMessage, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    })));\n  }\n\n}\n\nconst mapDispatchToProps = dispatch => ({\n  toggleHidden: () => dispatch(toggleChatModal())\n});\n\nconst mapStateToProps = createStructuredSelector({\n  user: selectCurrentUser\n});\nexport default connect(mapStateToProps, mapDispatchToProps)(Chat);","map":{"version":3,"sources":["/Users/daylanberry/Desktop/clothing/client/src/components/chat-components/Chat.jsx"],"names":["React","connect","toggleChatModal","ChatManager","TokenProvider","SendMessage","MessageList","RoomList","selectCurrentUser","createStructuredSelector","keys","axios","Chat","Component","constructor","props","sendMessage","text","roomId","currentUser","sendSimpleMessage","state","getRooms","getJoinableRooms","then","joinableRooms","setState","joinedRooms","rooms","catch","err","console","log","subscribeToRoom","messages","hooks","onMessage","message","room","id","createUser","user","post","username","res","userId","componentDidMount","displayName","chatManager","instanceLocator","tokenProvider","url","tokenUrl","render","toggleHidden","mapDispatchToProps","dispatch","mapStateToProps"],"mappings":"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","sourcesContent":["import React from 'react'\nimport './Chat.scss'\nimport { connect } from 'react-redux'\nimport { toggleChatModal } from '../../redux/chat/chat.actions'\nimport { ChatManager, TokenProvider} from '@pusher/chatkit-client'\n\nimport SendMessage from './SendMessage'\nimport MessageList from './MessageList'\nimport RoomList from './RoomList'\nimport { selectCurrentUser } from '../../redux/user/user.selector'\nimport { createStructuredSelector } from 'reselect'\n\nimport keys from '../../keys.js'\nimport axios from 'axios'\n\n\nclass Chat extends React.Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      messages: [],\n      currentUser: {},\n      joinableRooms: [],\n      joinedRooms: [],\n      roomId: null,\n      userId: ''\n    }\n  }\n\n  componentDidMount() {\n\n    console.log(this.props.user.displayName)\n\n    const chatManager = new ChatManager({\n      instanceLocator: keys.instanceLocator,\n      userId: 'daylan',\n      tokenProvider: new TokenProvider({url: keys.tokenUrl})\n    })\n\n    chatManager.connect()\n    .then(currentUser => {\n      this.currentUser = currentUser\n      this.getRooms()\n    })\n    .catch(err => console.log(err))\n  }\n\n\n  sendMessage = (text, roomId) => {\n    this.currentUser.sendSimpleMessage({\n      text,\n      roomId: this.state.roomId,\n    })\n  }\n\n  getRooms = () => {\n  this.currentUser.getJoinableRooms()\n    .then(joinableRooms => {\n      this.setState({\n        joinableRooms,\n        currentUser: this.currentUser,\n        joinedRooms: this.currentUser.rooms\n      })\n    })\n    .catch(err => console.log(err))\n  }\n\n  subscribeToRoom = (roomId) =>{\n    this.setState({messages: []})\n    this.currentUser.subscribeToRoom({\n      roomId: roomId,\n        hooks: {\n          onMessage: message => {\n            this.setState({\n              messages: [...this.state.messages, message]\n            })\n          }\n        }\n    })\n    .then(room => {\n      this.setState({\n        roomId: room.id\n      })\n    })\n    .catch(err => console.log(err))\n\n  }\n\n  createUser = (user) => {\n    axios.post('/users', {\n      username: user\n    })\n    .then((res) => console.log(res))\n    .catch(err => console.log(err))\n  }\n\n\n  render() {\n    return (\n      <div className='container'>\n        <div className='chat-container'>\n          <div className='content'>\n            <aside className='rooms'>\n              <RoomList\n                rooms={[...this.state.joinableRooms, ...this.state.joinedRooms]}\n                subscribeToRoom={this.subscribeToRoom}\n                roomId={this.state.roomId}\n              />\n            </aside>\n\n            <section className='texts'>\n              <MessageList messages={this.state.messages}/>\n            </section>\n            <span onClick={() => this.props.toggleHidden()}>&#10005;</span>\n          </div>\n            <SendMessage/>\n        </div>\n      </div>\n\n    )\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  toggleHidden: () => dispatch(toggleChatModal())\n})\n\nconst mapStateToProps = createStructuredSelector({\n  user: selectCurrentUser\n})\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Chat)"]},"metadata":{},"sourceType":"module"}